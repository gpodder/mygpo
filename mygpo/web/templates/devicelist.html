{% extends "base.html" %}
{% load i18n %}
{% load humanize %}
{% load devices %}

{% load menu %}
{% block mainmenu %}{{ "/devices/"|main_menu }}{% endblock %}
{% block sectionmenu %}{{ "/devices/"|section_menu }}{% endblock %}

{% block title %}{% trans "Managed Devices" %}{% endblock %}

{% block header %}
   <h1>{% trans "Managed Devices" %}</h1>
{% endblock %}

{% block content %}

 {% if device_groups %}
   <table class="list">
    <tr>
     <th>{% trans "Name" %}</th>
     <th>{% trans "Type" %}</th>
     <th>{% trans "Device ID" %}</th>
     <th class="buttons">{% trans "Configure" %}</th>
    </tr>
    {% for group in device_groups %}
     <tr>
      {% if group.is_synced %}
       <th colspan="4">{% trans "Synchronized" %}</th>
      {% else %}
       <th colspan="4">{% trans "Not Synchronized" %}</th>
      {% endif %}
     </tr>

     {% for device in group.devices %}
      <tr>
       <td><a href="{% url device device.uid %}">{{ device|device_icon }}{{ device.name|striptags }}</a></td>
       <td>{{ device|device_type }}</td>
       <td>{{ device.uid|striptags }}</td>
       <td>
        <a class="btn btn-small" href="{% url device-edit device.uid %}">
         <i class="icon-edit"></i>
         {% trans "Configure" %}
        </a>
       </td>
      </tr>
     {% endfor %}
    {% endfor %}
   </table>

  {% else %}

   <p>
    {% blocktrans %}You don't have any devices yet. Go to the <a href="http://wiki.gpodder.org/wiki/Web_Services/Clients">clients</a> page to learn how to set up your client applications.{% endblocktrans %}
   </p>

  {% endif %}

   {% if deleted_devices %}
    <h2>{% trans "Deleted Devices" %}</h2>
    <table class="list">
    {% for d in deleted_devices %}
     <tr>
      <td><a href="{% url device d.uid %}">{{ d|device_icon }}{{ d.name|striptags }}</a></td>
      <td>{{ d|device_type }}</td>
      <td>{{ d.uid|striptags }}</td>
      <td>
       <form method="post" action="{% url device-undelete d.uid %}">
        <button class="btn btn-small" type="submit">
         <i class="icon-repeat"></i> {% trans "Reactivate" %}
        </button>
       </form>
      </td>
      <td>
       <form method="post" action="{% url device-delete-permanently d.uid %}">
        <button class="btn btn-danger btn-small" type="submit">
         <i class="icon-trash"></i> {% trans "Delete Permanently" %}
        </button>
       </form>
      </td>

     </tr>
    {% endfor %}
   </table>
   {% endif %}

{% endblock %}


{% block sidebar %}

  <div class="well">

   <h4>{% trans "Adding New Devices" %}</h4>
   <p>
    {% trans "Just upload your subscriptions from a client, and it will automatically show up here." %}
   </p>

   <p>
    {% trans "You can also manually create a new device." %}
   </p>

    <a class="btn btn-success" href="{% url device-edit-new %}">
     <i class="icon-plus"></i> {% trans "Create Device" %}
    </a>

 </div>

{% endblock %}

